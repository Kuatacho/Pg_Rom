<!-- CONTENEDOR PRINCIPAL -->
<div class="min-h-screen bg-gradient-to-br from-[#8b6b46] to-[#b8996c] flex flex-col items-center py-10 px-4">

  <!-- üè∑Ô∏è T√çTULO GLOBAL -->
  <div class="text-center mb-8">
    <h1 class="text-4xl md:text-5xl font-extrabold text-[#322203] tracking-tight drop-shadow-sm">
      Crea una cuenta
    </h1>
    <p class="text-gray-100/90 mt-1 text-base font-medium">
      Registra a tu personal a VISION
    </p>
  </div>

  <!-- TARJETA PRINCIPAL -->
  <div class="w-full max-w-5xl bg-white rounded-3xl shadow-2xl border border-[#322203]/10 overflow-hidden">
    <div class="grid md:grid-cols-2">

      <!-- LADO IMAGEN -->
      <div class="hidden md:flex items-center justify-center bg-[#f6f2ec]">
        <img
          src="https://cdn-icons-png.flaticon.com/512/6521/6521996.png"
          alt="Registro de usuario"
          class="w-2/3 max-w-sm drop-shadow-lg transition-transform duration-500 hover:scale-105"
        />
      </div>

      <!-- LADO FORMULARIO -->
      <div class="p-8 md:p-10 bg-[#fbf9f5]">
        <form [formGroup]="form" (ngSubmit)="submit()" class="space-y-4">

          <!-- NOMBRE -->
          <div>
            <label class="label">Nombre</label>
            <input type="text" formControlName="nombre" class="input" placeholder=""/>
            <p *ngIf="form.get('nombre')?.touched && form.get('nombre')?.invalid" class="error">
              <span *ngIf="form.get('nombre')?.errors?.['required']">El nombre es obligatorio.</span>
              <span *ngIf="form.get('nombre')?.errors?.['pattern']">Solo se permiten letras.</span>
              <span *ngIf="form.get('nombre')?.errors?.['minlength']">Debe tener al menos 2 caracteres.</span>
            </p>
          </div>

          <!-- APELLIDOS -->
          <div>
            <label class="label">Apellidos</label>
            <input type="text" formControlName="apellidos" class="input" placeholder=""/>
            <p *ngIf="form.get('apellidos')?.touched && form.get('apellidos')?.invalid" class="error">
              <span *ngIf="form.get('apellidos')?.errors?.['required']">Los apellidos son obligatorios.</span>
              <span *ngIf="form.get('apellidos')?.errors?.['pattern']">Solo se permiten letras.</span>
            </p>
          </div>

          <!-- Correo -->
          <div>
            <label class="label">Correo electr√≥nico</label>
            <input
              type="email"
              formControlName="correo"
              class="input"
              placeholder="correo@ejemplo.com"
              autocomplete="email"
            />

            <!-- üß© Alerta de validaci√≥n -->
            <p *ngIf="form.get('correo')?.touched && form.get('correo')?.invalid" class="error">
              <span *ngIf="form.get('correo')?.errors?.['required']">El correo electr√≥nico es obligatorio.</span>
              <span *ngIf="form.get('correo')?.errors?.['email']">Debe tener un formato v√°lido de email .</span>
            </p>
          </div>

          <!-- Rol -->
          <div>
            <label class="label">Rol</label>
            <select formControlName="rol" class="input">
              <option *ngFor="let rol of roles()" [value]="rol">{{ rol }}</option>
            </select>
          </div>

          <!-- G√©nero + Fecha -->
          <div class="grid grid-cols-2 gap-4">
            <div>
              <label class="label">G√©nero</label>
              <select formControlName="genero" class="input">
                <option value="">Seleccionar</option>
                <option value="Masculino">Masculino</option>
                <option value="Femenino">Femenino</option>
                <option value="Otro">Otro</option>
              </select>
            </div>

            <!-- FECHA NAC -->
            <div>
              <label class="label">Fecha Nac.</label>
              <input type="date" formControlName="fecha_nacimiento" class="input"/>
              <p *ngIf="form.get('fecha_nacimiento')?.touched && form.get('fecha_nacimiento')?.invalid" class="error">
                <span *ngIf="form.get('fecha_nacimiento')?.errors?.['required']">La fecha es obligatoria.</span>
                <span *ngIf="form.get('fecha_nacimiento')?.errors?.['edadMinima']">Debe tener al menos 7 a√±os.</span>
              </p>
            </div>
          </div>

          <!-- CELULAR -->
          <div>
            <label class="label">Celular</label>
            <input type="text" formControlName="celular" class="input" placeholder=""/>
            <p *ngIf="form.get('celular')?.touched && form.get('celular')?.invalid" class="error">
              <span *ngIf="form.get('celular')?.errors?.['required']">El n√∫mero es obligatorio.</span>
              <span *ngIf="form.get('celular')?.errors?.['pattern']">Debe tener 8 d√≠gitos y comenzar con 6 o 7.</span>
            </p>
          </div>

          <!-- Bot√≥n -->
          <button type="submit" [disabled]="loading()" class="btn-primary w-full mt-4">
            <ng-container *ngIf="!loading(); else loadingTpl">Registrarme</ng-container>
          </button>

          <ng-template #loadingTpl>
            <span class="inline-flex items-center gap-2">
              <svg class="animate-spin h-5 w-5" viewBox="0 0 24 24" fill="none">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z" fill="currentColor"></path>
              </svg>
              Registrando‚Ä¶
            </span>
          </ng-template>

        </form>

        <p *ngIf="error()" class="text-sm text-red-600 text-center mt-4 font-medium">
          {{ error() }}
        </p>
      </div>
    </div>
  </div>
</div>

<!-- MODAL -->
<div *ngIf="showModal()" class="fixed inset-0 flex items-center justify-center bg-black/50 backdrop-blur-sm z-[9999]">
  <div class="bg-white rounded-2xl shadow-2xl p-6 w-full max-w-sm text-center animate-fadeIn">
    <h2 class="text-2xl font-bold text-[#322203] mb-2"> Registro exitoso</h2>
    <p class="text-gray-700 mb-4">
      El usuario fue creado correctamente y sus credenciales fueron enviadas a su correo electr√≥nico.
    </p>

    <button (click)="cerrarModal()" class="btn-primary mt-6 w-full">Aceptar</button>
  </div>
</div>
